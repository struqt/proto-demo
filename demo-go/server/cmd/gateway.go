package cmd

import (
	"context"
	"github.com/golang/glog"
	"github.com/struqt/proto-demo/demo-go/server/gateway"
)

// RunGateway
// Gateway is a reverse-proxy implementation whose HTTP handler is generated by grpc-gateway.
func RunGateway() {
	defer glog.Flush()
	ctx := context.Background()
	opts := gateway.Options{
		Addr:       ":8080",
		OpenAPIDir: *openAPIDir,
		GRPCServer: gateway.Endpoint{Network: *network, Addr: *address},
	}
	if err := gateway.Run(ctx, opts); err != nil {
		glog.Fatal(err)
	}
	// curl -s 127.0.0.1:8080/demo/v3/echo --data '{"value":[{},[],false,null,0.5,"hello"]}' | jq
}
